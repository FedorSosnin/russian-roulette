:root {
  --wood-dark: #4f2a15;
  --wood-mid: #6b3a1c;
  --wood-light: #8a552e;
  --felt: #2b1b10;
  --text: #f4efe8;
  --accent: #d8c4a5;
  --card-width: clamp(240px, 56vw, 480px);
  --card-height: calc(var(--card-width) * 0.7);
  --stack-offset: 3px;
  --placeholder-offset: 60px;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: "Trebuchet MS", "Gill Sans", "Calibri", sans-serif;
  color: var(--text);
  min-height: 100vh;
  user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
  background-color: var(--wood-dark);
  background-image:
    radial-gradient(circle at 20% 10%, rgba(255, 255, 255, 0.08), transparent 40%),
    radial-gradient(circle at 80% 30%, rgba(0, 0, 0, 0.2), transparent 45%),
    url("Assets/Table Texture/wood-table-nlTQ-hLe.jpg");
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
}

html,
body {
  overflow: hidden;
}

body.intro-start .deck {
  display: none;
  pointer-events: none;
}

body.intro-playing .deck {
  display: grid;
  visibility: hidden;
  pointer-events: none;
}

.start-screen {
  position: absolute;
  width: var(--card-width);
  height: var(--card-height);
  top: 0;
  left: 50%;
  cursor: pointer;
  opacity: 0;
  pointer-events: none;
  border-radius: 14px;
  background: url("Assets/Icons/rr-deck-placeholder.png") center / cover no-repeat;
  box-shadow: none;
  mix-blend-mode: soft-light;
  transform: translate(-50%, var(--placeholder-offset)) rotate(-1.6deg);
  z-index: 6;
}

body.intro-start .start-screen {
  opacity: 0.6;
  pointer-events: auto;
}

body.intro-playing .start-screen {
  opacity: 0.6;
  pointer-events: none;
}

.table {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  gap: 18px;
  padding: 24px 16px 32px;
}

.play-area {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 70px 12px 32px;
  border-radius: 28px;
  min-height: 300px;
  position: relative;
}

.center-stack {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 28px;
  flex: 1;
  justify-content: center;
  width: 100%;
  position: relative;
  top: -30px;
  z-index: 3;
}

.deck {
  display: grid;
  place-items: center;
  gap: 8px;
  padding: 0;
  cursor: pointer;
  user-select: none;
  position: relative;
  touch-action: manipulation;
  z-index: 5;
  perspective: 1100px;
  width: var(--card-width);
  height: var(--card-height);
}

.deck.dragging {
  z-index: 9;
}

.deck .stack-card {
  position: absolute;
  width: var(--card-width);
  height: var(--card-height);
  top: 0;
  left: 0;
  border-radius: 14px;
  background-image: url("Assets/Cards/rr-card-back.jpg");
  background-size: cover;
  background-position: center;
  box-shadow:
    0 16px 18px rgba(0, 0, 0, 0.32),
    0 8px 10px rgba(0, 0, 0, 0.2);
  --stack-x: calc(var(--stack-offset) * var(--i, 1));
  --stack-y: calc(var(--stack-offset) * var(--i, 1));
  --stack-rot: var(--rot, -1.6deg);
  transform: translate(var(--stack-x), var(--stack-y)) rotate(var(--stack-rot));
  z-index: 1;
  display: none;
}

.deck-placeholder {
  position: absolute;
  width: var(--card-width);
  height: var(--card-height);
  top: 0;
  left: 0;
  border-radius: 14px;
  object-fit: cover;
  box-shadow: none;
  transform: translateY(60px) rotate(-1.6deg);
  mix-blend-mode: soft-light;
  opacity: 0;
  z-index: 0;
  visibility: hidden;
  display: none;
}

.deck-placeholder.visible {
  visibility: visible;
  display: block;
  opacity: 0.6;
}

.stack-enter {
  animation: stack-in 320ms ease-out forwards;
  animation-fill-mode: both;
}

.deck .stack-card:nth-child(1) {
  --i: 1;
  --rot: -1.8deg;
}

.deck .stack-card:nth-child(2) {
  --i: 2;
  --rot: 1.4deg;
}

.deck .stack-card:nth-child(3) {
  --i: 3;
  --rot: -1.0deg;
}

.deck .stack-card:nth-child(4) {
  --i: 4;
  --rot: 1.6deg;
}

.deck .stack-card:nth-child(5) {
  --i: 5;
  --rot: -1.4deg;
}

.deck .stack-card:nth-child(6) {
  --i: 6;
  --rot: 0.8deg;
}

.deck .stack-card:nth-child(7) {
  --i: 7;
  --rot: -1.2deg;
}

.deck img {
  width: var(--card-width);
  height: var(--card-height);
  border-radius: 14px;
  box-shadow:
    0 20px 24px rgba(0, 0, 0, 0.35),
    0 10px 14px rgba(0, 0, 0, 0.25);
  --stack-x: calc(var(--stack-offset) * 8);
  --stack-y: calc(var(--stack-offset) * 8);
  --stack-rot: -1.6deg;
  transform: translate(var(--stack-x), var(--stack-y)) rotate(var(--stack-rot));
  object-fit: cover;
  position: relative;
  z-index: 2;
  transform-origin: center;
  -webkit-user-drag: none;
  user-select: none;
  visibility: hidden;
  opacity: 0;
}

#deck-top.stack-enter {
  animation: stack-in 320ms ease-out forwards;
}

#deck-top {
  transition: transform 1s ease;
}

#deck-top.stop-animation {
  animation: none !important;
}

@keyframes deck-float {
  0% {
    transform: translate(var(--stack-x), var(--stack-y)) rotate(var(--stack-rot)) scale(1);
  }

  25% {
    transform: translate(calc(var(--stack-x) + 1.7px), calc(var(--stack-y) - 4.5px)) rotate(calc(var(--stack-rot) + 0.6deg)) scale(1.015);
  }

  50% {
    transform: translate(calc(var(--stack-x) - 1.1px), calc(var(--stack-y) - 2.2px)) rotate(calc(var(--stack-rot) - 0.3deg)) scale(1.005);
  }

  75% {
    transform: translate(calc(var(--stack-x) + 0.6px), calc(var(--stack-y) - 5.5px)) rotate(calc(var(--stack-rot) + 0.3deg)) scale(1.025);
  }

  100% {
    transform: translate(var(--stack-x), var(--stack-y)) rotate(var(--stack-rot)) scale(1);
  }
}

#deck-top:not(.stack-enter):not(.dragging):not(.stack-offscreen) {
  animation: deck-float 5.4s ease-in-out infinite;
  will-change: transform;
}

.deck img.dragging {
  z-index: 11;
}

body.intro-loading .deck,
body.intro-loading .deck * {
  visibility: visible;
}

.stack-offscreen {
  transform: translate(var(--stack-x), calc(var(--stack-y) - 120vh)) rotate(calc(var(--stack-rot) - 6deg));
}

.deck.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.cards-area {
  width: var(--card-width);
  height: var(--card-height);
  position: relative;
  margin-top: 35px;
  z-index: 3;
  cursor: pointer;
}

.cards-area.dealing {
  z-index: 12;
}

.cards-area.dragging {
  z-index: 12;
}

.card {
  width: var(--card-width);
  height: var(--card-height);
  perspective: 1000px;
  position: relative;
  position: absolute;
  top: 0;
  left: 0;
  transform: translate(var(--to-x, 0px), var(--to-y, 0px)) rotate(var(--tilt, 0deg));
  z-index: 2;
}

.card.deal {
  animation: deal-move 380ms ease-out;
  z-index: 8;
}

.card.dragging {
  z-index: 9;
}

.card-inner {
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  animation: flip 420ms ease-out forwards;
}

.card-face {
  position: absolute;
  inset: 0;
  backface-visibility: hidden;
  border-radius: 16px;
  box-shadow:
    0 22px 28px rgba(0, 0, 0, 0.35),
    0 10px 14px rgba(0, 0, 0, 0.25);
  overflow: hidden;
}

.card-back {
  transform: rotateX(0deg);
}

.card-front {
  transform: rotateX(-180deg);
}

.card-face img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}


@keyframes deal-move {
  from {
    transform: translate(var(--from-x), var(--from-y)) rotate(var(--tilt, 0deg));
  }

  to {
    transform: translate(var(--to-x, 0px), var(--to-y, 0px)) rotate(var(--tilt, 0deg));
  }
}

@keyframes flip {
  from {
    transform: rotateX(0deg);
  }

  to {
    transform: rotateX(-180deg);
  }
}

@keyframes stack-in {
  from {
    transform: translate(var(--stack-x), calc(var(--stack-y) - 100vh)) rotate(calc(var(--stack-rot) - 6deg));
  }

  to {
    transform: translate(var(--stack-x), var(--stack-y)) rotate(var(--stack-rot));
  }
}

.counters {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  margin-top: 6px;
  width: var(--card-width);
  min-height: 78px;
}

.cube-row {
  display: flex;
  align-items: center;
}

.counter-dot {
  width: 78px;
  height: 78px;
  border-radius: 0;
  background: url("Assets/Icons/rr-cube.png") center / contain no-repeat;
  box-shadow: none;
  transform: translateY(var(--cube-y, 0px)) rotate(var(--cube-rot, 0deg));
  transition: transform 160ms ease;
}

.counter-dot.active {
  transform: translateY(var(--cube-y, 0px)) rotate(var(--cube-rot, 0deg));
}

.cube-row .counter-dot+.counter-dot {
  margin-left: -8px;
}

.counter-dot.cube-enter {
  animation: cube-drop 320ms ease-out forwards;
}

@keyframes cube-drop {
  from {
    transform: translateY(calc(var(--cube-y, 0px) + 60px)) rotate(calc(var(--cube-rot, 0deg) - 12deg));
  }

  to {
    transform: translateY(var(--cube-y, 0px)) rotate(var(--cube-rot, 0deg));
  }
}

.counter-dot.fade-out {
  animation: dot-fade 3s ease forwards;
}

@keyframes dot-fade {
  from {
    opacity: 1;
  }

  to {
    opacity: 0;
  }
}

@media (max-width: 900px) {
  :root {
    --card-width: clamp(280px, 84vw, 560px);
    --placeholder-offset: 60px;
  }

  .play-area {
    flex-direction: column;
    padding: 90px 12px 28px;
  }

  .center-stack {
    gap: 42px;
    top: -60px;
  }

  .counters {
    gap: 0;
    margin-left: -49px;
  }

  .cube-row .counter-dot+.counter-dot {
    margin-left: -24px;
  }

  .deck {
    justify-self: center;
  }

}


.version-tag {
  position: fixed;
  left: 12px;
  bottom: 12px;
  font-size: 8pt;
  color: #D2B48C;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
  letter-spacing: 0.3px;
  pointer-events: none;
}